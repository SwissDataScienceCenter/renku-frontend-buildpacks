#!/usr/bin/env bash
set -eo pipefail

echo "=== Renku Environment Variables buildpack ==="


layers_dir="$1"
layer_dir="${layers_dir}"/renku-env
env_dir="${layer_dir}"/env.launch
mkdir -p "${env_dir}"

printf "/bin/bash" >"${env_dir}/SHELL.default"
printf "0.0.0.0" >"${env_dir}/RENKU_SESSION_IP.default"
printf "8000" >"${env_dir}/RENKU_SESSION_PORT.default"
printf "/workspace" >"${env_dir}/RENKU_MOUNT_DIR.default"
printf "/workspace" >"${env_dir}/RENKU_WORKING_DIR.default"
printf "/" >"${env_dir}/RENKU_BASE_URL_PATH.default"

cat >"${layer_dir}.toml" <<EOL
[types]
launch = true
EOL
